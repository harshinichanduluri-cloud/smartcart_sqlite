<!DOCTYPE html>
<html>
<head>
    <title>All Products</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body class="admin-item-list">
   
<div class="admin-page">

<h1 style="color: white;">Product List</h1>

<br>
<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% for category, message in messages %}
    <p style="color:green;">{{ message }}</p>
  {% endfor %}
{% endwith %}

<!-- Search Form -->
<form method="GET" action="/admin/item-list">
    <input type="text" name="search" placeholder="Search product..."  
           class="search-input"
           value="{{ request.args.get('search', '') }}">
    <button type="submit" class="search-btn">Search</button>
</form>

<br>

<!-- Category Filter -->
<form method="GET" action="/admin/item-list">
    <select name="category" class="category-select">
        <option value="">All Categories</option>

        {% for cat in categories %}
        <option value="{{ cat.category }}"
            {% if request.args.get('category') == cat.category %} selected {% endif %}>
            {{ cat.category }}
        </option>
        {% endfor %}
    </select>
    <button type="submit" class="filter-btn">Filter</button>
</form>

<br>

<a href="/admin/add-item" class="add-product-btn">+ Add New Product</a>

<br><br>

<table class="admin-table" border="1" cellpadding="10" >
    <tr>
        <th>ID</th>
        <th>Image</th>
        <th>Name</th>
        <th>Category</th>
        <th>Price</th>
        <th>View</th>
        <th>Update</th>
        <th>Delete</th>
    </tr>

    {% for product in products %}
    <tr>
        <td>{{ product.product_id }}</td>

        <td>
            <img src="/static/uploads/product_images/{{ product.image }}" 
                 width="70" height="70">
        </td>

        <td>{{ product.name }}</td>
        <td>{{ product.category }}</td>
        <td>₹{{ product.price }}</td>

        <td>
            <a href="/admin/view-item/{{ product.product_id }}" 
   class="admin-btn secondary">
   View
</a>
        </td>
    <td>
    <a href="/admin/update-item/{{ product.product_id }}"
       class="edit-btn">
       Update
    </a>
</td>
<td>
     <a href="/admin/delete-item/{{ product.product_id }}"
               class="delete-btn" 
               onclick="return confirm('Are you sure you want to delete this product?')">Delete</a>

</td>
    </tr>
    {% endfor %}
</table>
<a href="/admin-dashboard" >
    ← Back to Dashboard
</a>

</div>


</body>
</html>